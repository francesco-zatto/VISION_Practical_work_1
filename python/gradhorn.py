def gradhorn(I1, I2):
    Ix = 0.25 * (I1[:-1, 1:] - I1[:-1, :-1] + I1[1:, 1:] - I1[1:, :-1] +
                 I2[:-1, 1:] - I2[:-1, :-1] + I2[1:, 1:] - I2[1:, :-1])
    Iy = 0.25 * (I1[1:, :-1] - I1[:-1, :-1] + I1[1:, 1:] - I1[:-1, 1:] +
                 I2[1:, :-1] - I2[:-1, :-1] + I2[1:, 1:] - I2[:-1, 1:])
    It = 0.25 * (I2[:-1, :-1] - I1[:-1, :-1] + I2[1:, :-1] - I1[1:, :-1] +
                 I2[:-1, 1:] - I1[:-1, 1:] + I2[1:, 1:] - I1[1:, 1:])
    return Ix, Iy, It